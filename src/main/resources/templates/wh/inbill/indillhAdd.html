<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="zh-cn">
<head>
    <div th:include="common/headEdit"/>
    <title>添加验货入库信息</title>
</head>
<body>
<div class="panel admin-panel">
    <div class="panel-head" id="add"><strong><span class="icon-pencil-square-o"></span>添加验货入库信息</strong></div>
    <div class="body-content">
        <form method="post" th:action="@{/indillh/add}" class="form-x" id="indillHAdd">
            <input type="hidden" name="itemtypecode" id="itemtypecode"/>
            <table align="center" width="80%" style="border-collapse:separate; border-spacing:0px 10px;">
                <tr>
                    <td style="text-align:right ">
                        <label>入库单号：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" readonly name="inbillcode" th:field="${indill.inbillcode}"
                               style="line-height: 25px;height: 25px;">
                        <span style="color: red;"></span>
                        <span></span>
                    </td>
                    <td style="text-align:right ">
                        <label>采购单号：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" readonly th:field="${indill.oldbill}" name="oldbill"
                               style="line-height: 25px;height: 25px;">
                        <span style="color: red;"></span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>仓库名称：</label>
                    </td>
                    <td style="text-align:left ">
                        <select name="warecode" th:field="${indill.warecode}" class="selectpicker" title="请选择仓库"
                                data-live-search="true" multiple
                                data-max-options="1">
                            <option required th:each="w : ${ware}" th:text="${w.warename}"
                                    th:value="${w.warecode}"></option>
                        </select>
                        <!-- <span th:errors="${whInbillH.warecode}"></span>-->
                    </td>
                    <td style="text-align:right ">
                        <label>供应商：</label>
                    </td>
                    <td style="text-align:left ">
                        <select name="supplyname" th:field="${indill.supplyname}" class="selectpicker" title="请选择供应商"
                                data-live-search="true" multiple
                                data-max-options="1">
                            <option th:each="s : ${serve}" th:text="${s.servename}" th:value="${s.servename}"></option>
                        </select>
                        <span></span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>客户名称：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" th:field="${indill.custname}" style="line-height: 25px;height: 25px;"
                               name="custname">
                    </td>
                    <td style="text-align:right ">
                        <label>运输方式：</label>
                    </td>
                    <td style="text-align:left ">
                        <select name="trantype" th:field="${indill.trantype}" class="selectpicker" title="请选择方式">
                            <option value="0">汽车</option>
                            <option value="1">火车</option>
                            <option value="2">转存</option>
                            <option value="3">船运</option>
                        </select>
                        <span></span>
                    </td>
                </tr>
                <tr>
                <tr>
                    <td style="text-align:right ">
                        <label>承运商：</label>
                    </td>
                    <td style="text-align:left ">
                        <select name="carrier" th:field="${indill.carrier}" class="selectpicker" title="请选择承运商"
                                data-live-search="true" multiple
                                data-max-options="1">
                            <option th:each="t : ${tranunit}" th:text="${t.tranname}" th:value="${t.tranname}"></option>
                        </select>
                        <span></span>
                    </td>
                    <td style="text-align:right ">
                        <label>承运车辆：</label>
                    </td>
                    <td style="text-align:left ">
                        <select id="vehicle" th:field="${indill.vehicle}" name="vehicle" class="selectpicker"
                                title="请选择承运车辆" data-live-search="true"
                                multiple data-max-options="1">
                            <option th:each="v : ${vehilce}" th:text="${v.vehicleid}"
                                    th:value="${v.vehicleid}"></option>
                        </select>
                        <span></span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>送货司机：</label>
                    </td>
                    <td style="text-align:left "><input type="text" id="driver" th:field="${indill.driver}"
                                                        style="line-height: 25px;height: 25px;"
                                                        name="driver"></td>
                    <td style="text-align:right ">
                        <label>身份证号：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" id="identifyId" th:field="${indill.identifyId}"
                               style="line-height: 25px;height: 25px;"
                               name="identifyId"></td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>采购合同：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" readonly name="contactbill" th:field="${indill.contactbill}"
                               style="line-height: 25px;height: 25px;"
                        >
                        <span style="color: red;"></span>
                        <span></span>
                    </td>
                    <td style="text-align:right ">
                        <label>提单号：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" name="serverbill" th:field="${indill.serverbill}"
                               style="line-height: 25px;height: 25px;">
                        <span style="color: red;"></span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>司机电话：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" name="motormanTel" style="line-height: 25px;height: 25px;"
                               th:field="${indill.motormanTel}"
                        >
                        <span style="color: red;"></span>
                        <span></span>
                    </td>
                    <td style="text-align:right ">
                        <label>入库日期：</label>
                    </td>
                    <td style="text-align:left ">
                        <!--<input type="text" name="indate"
                               style="line-height: 25px;height: 25px;">-->
                        <div class="input-group date form_date col-md-5" style="padding-left:10px" data-date=""
                             data-date-format="" data-link-field="dtp_input1" data-link-format="yyyy-mm-dd">
                            <input type="text" class="input w110" id="indate" name="indate" th:field="${indill.indate}"
                                   data-validate="required:请输入内容"
                                   required>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span> </span>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span> </span>
                        </div>
                        <span style="color: red;"></span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>验货人：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" name="tellman" th:field="${indill.tellman}" required
                               style="line-height: 25px;height: 25px;">
                        <span style="color: red;"></span>
                    </td>
                    <td style="text-align:right ">
                        <label>发单日期：</label>
                    </td>
                    <td style="text-align:left ">
                        <!--                        <input type="text" name="senddate" style="line-height: 25px;height: 25px;">-->
                        <div class="input-group date form_date col-md-5" style="padding-left:10px" data-date=""
                             data-date-format="" data-link-field="dtp_input1" data-link-format="yyyy-mm-dd">
                            <input type="text" class="input w110" id="senddate" th:field="${indill.senddate}"
                                   name="senddate"
                                   data-validate="required:请输入内容"
                                   required>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span> </span>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span> </span>
                        </div>
                        <span style="color: red;"></span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right ">
                        <label>采购类型：</label>
                    </td>
                    <td style="text-align:left ">
                        <select name="purType" th:field="${indill.purtype}" class="selectpicker" title="请选择采购类型">
                            <option value="0">合同采购</option>
                            <option value="1">临时采购</option>
                            <option value="2">冲减期初余额</option>
                        </select>
                        <span></span>
                    </td>
                    <td style="text-align:right ">
                        <label>备注：</label>
                    </td>
                    <td style="text-align:left ">
                        <input type="text" style="line-height: 25px;height: 25px;" name="remark"
                               th:field="${indill.remark}"
                        ></td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <br/>
                <br/>
                <br/>
                <tr>
                    <td colspan="4" style="text-align:center ">
                        <!--                        onclick="$('#indillHAdd').submit()"-->
                        <input class="button bg-main icon-check-square-o button-small" type="submit"> </input>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>
<script>
    $("#indillHAdd").on("submit", function (ev) {
        ev.preventDefault(
            $.ajax({
                url: "/indillh/add",
                data: $("#indillHAdd").serialize(),
                success: function (data) {
                    alert(data.msg);
                    console.log(data.msg);
                    if (data !== "error") {
                        window.location.href = "/indillh/toAddItem?id="+ data.msg;
                    }
                },
                error: function (data) {
                    alert("error")
                }
            })
        )
        return false;
    });

    $("#vehicle").change(function () {
        var result = $("#vehicle").val();
        $.ajax({
            url: "/indillh/vehicle/" + result,
            success: function (data) {
                $("#driver").val(data.driver);
                $("#identifyId").val(data.driverid);
            }
        })
    })

    //校验后提交
    /*$("#frm_bbsedit").on("submit", function(ev) {
        //阻止submit表单提交
        ev.preventDefault(
            $.ajax({
                type: "post",
                url: "/bbs/addUptSave?pid=",
                data: $('#frm_bbsedit').serialize(),
                success: function (result) {
                    console.log(result.code);
                    if (result.code) {
                        alert("提交成功");
                        window.location.href = "/bbs/list";
                    } else {
                        // document.getElementById("testid").innerHTML= result.msg;
                        alert("数据提交失败！");
                        return false;
                    }
                },
                error: function (result) {
                    alert("error");
                }})

        );
        return false;
    });*/
    //校验成功后调用公共的提交方法 该方法调试有问题提时屏蔽
    /*  function submitForm() {
          alert("调用submitForm");
          $.ajax({
              type: "post",
              url: "/bbs/addUptSave?pid=",
              data: $('#frm_bbsedit').serialize(),
              success: function (result) {
                  console.log(result.code);
                  alert("返回结果");
                  if (result.code) {
                      alert("提交成功");
                      window.location.href = "/bbs/list";
                  } else {
                      // document.getElementById("testid").innerHTML= result.msg;
                      alert("数据提交失败！");
                      return false;
                  }
              },
              error: function (result) {
                  alert("error");
              }
          })
      }*/
</script>
</body>
</html>